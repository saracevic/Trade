<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Trade Scanner Pro | Cryptocurrency Market Tracking</title>
  <meta name="description" content="Professional multi-exchange cryptocurrency trading pair scanner with real-time market analysis">
  <meta name="keywords" content="cryptocurrency, trading, scanner, binance, coinbase, kraken, market analysis">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --dark: #0f172a;
      --dark-light: #1e293b;
      --gray: #64748b;
      --gray-light: #cbd5e1;
      --white: #ffffff;
      --shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);
      --shadow-lg: 0 25px 50px -12px rgba(0,0,0,.25);
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: var(--dark);
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      animation: fadeIn 0.6s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .header {
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      padding: 30px 40px;
      border-radius: 20px;
      margin-bottom: 30px;
      box-shadow: var(--shadow-lg);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      box-shadow: 0 4px 14px rgba(99,102,241,0.4);
    }
    
    .logo-text h1 {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .logo-text p {
      font-size: 13px;
      color: var(--gray);
      margin-top: 2px;
    }
    
    .stats {
      display: flex;
      gap: 30px;
      flex-wrap: wrap;
    }
    
    .stat-item {
      text-align: center;
    }
    
    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: var(--primary);
      display: block;
    }
    
    .stat-label {
      font-size: 12px;
      color: var(--gray);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 4px;
    }
    
    .controls-panel {
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      padding: 30px 40px;
      border-radius: 20px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
    }
    
    .search-section {
      margin-bottom: 25px;
    }
    
    .search-wrapper {
      position: relative;
      max-width: 500px;
    }
    
    .search-icon {
      position: absolute;
      left: 18px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
      font-size: 18px;
    }
    
    .search-input {
      width: 100%;
      padding: 16px 20px 16px 50px;
      border: 2px solid var(--gray-light);
      border-radius: 12px;
      font-size: 15px;
      font-family: inherit;
      transition: all 0.3s;
      background: var(--white);
    }
    
    .search-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(99,102,241,0.1);
    }
    
    .filters {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      align-items: center;
    }
    
    .filter-group {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 20px;
      background: var(--white);
      border: 2px solid var(--gray-light);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      user-select: none;
    }
    
    .filter-group:hover {
      border-color: var(--primary);
      background: rgba(99,102,241,0.05);
    }
    
    .filter-group.active {
      border-color: var(--primary);
      background: var(--primary);
      color: var(--white);
    }
    
    .checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid currentColor;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    
    .checkbox.checked::after {
      content: '‚úì';
      font-size: 14px;
      font-weight: 700;
    }
    
    .filter-label {
      font-size: 14px;
      font-weight: 500;
    }
    
    .btn {
      padding: 14px 28px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: var(--white);
      box-shadow: 0 4px 14px rgba(99,102,241,0.4);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(99,102,241,0.5);
    }
    
    .btn-primary:active {
      transform: translateY(0);
    }
    
    .table-container {
      background: rgba(255,255,255,0.98);
      backdrop-filter: blur(10px);
      padding: 30px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    
    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--gray-light);
    }
    
    .table-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--dark);
    }
    
    .result-count {
      padding: 6px 14px;
      background: var(--primary);
      color: var(--white);
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
    }
    
    .table-wrapper {
      overflow-x: auto;
    }
    
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }
    
    th {
      background: var(--dark);
      color: var(--white);
      padding: 16px 20px;
      text-align: left;
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      position: sticky;
      top: 0;
      z-index: 10;
    }
    
    th:first-child {
      border-radius: 12px 0 0 0;
    }
    
    th:last-child {
      border-radius: 0 12px 0 0;
    }
    
    td {
      padding: 18px 20px;
      border-bottom: 1px solid var(--gray-light);
      font-size: 14px;
    }
    
    tr:last-child td {
      border-bottom: none;
    }
    
    tr:hover td {
      background: rgba(99,102,241,0.05);
    }
    
    .badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      white-space: nowrap;
    }
    
    .badge-primary {
      background: rgba(99,102,241,0.1);
      color: var(--primary);
      border: 1px solid rgba(99,102,241,0.3);
    }
    
    .badge-success {
      background: rgba(16,185,129,0.1);
      color: var(--success);
      border: 1px solid rgba(16,185,129,0.3);
    }
    
    .badge-warning {
      background: rgba(245,158,11,0.1);
      color: var(--warning);
      border: 1px solid rgba(245,158,11,0.3);
    }
    
    .badge-exchange {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: var(--white);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .symbol {
      font-weight: 600;
      color: var(--dark);
      font-size: 15px;
    }
    
    .price {
      font-weight: 600;
      color: var(--success);
      font-family: 'Courier New', monospace;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
    }
    
    .empty-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }
    
    .empty-text {
      font-size: 18px;
      color: var(--gray);
      margin-bottom: 10px;
    }
    
    .empty-subtext {
      font-size: 14px;
      color: var(--gray-light);
    }
    
    .loading {
      text-align: center;
      padding: 40px;
    }
    
    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid var(--gray-light);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .loading-text {
      font-size: 16px;
      color: var(--gray);
    }
    
    .footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      color: rgba(255,255,255,0.9);
      font-size: 14px;
    }
    
    .footer a {
      color: var(--white);
      text-decoration: none;
      font-weight: 600;
      transition: opacity 0.3s;
    }
    
    .footer a:hover {
      opacity: 0.8;
    }
    
    .lang-toggle {
      background: rgba(255,255,255,0.2);
      border: 2px solid rgba(255,255,255,0.3);
      color: var(--white);
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .lang-toggle:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.5);
    }
    
    .export-btn {
      background: rgba(255,255,255,0.2);
      border: 2px solid rgba(255,255,255,0.3);
      color: var(--white);
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    
    .export-btn:hover {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.5);
    }
    
    @media (max-width: 768px) {
      .header {
        padding: 20px;
      }
      
      .logo-text h1 {
        font-size: 22px;
      }
      
      .stats {
        width: 100%;
        justify-content: space-around;
      }
      
      .controls-panel {
        padding: 20px;
      }
      
      .filters {
        flex-direction: column;
        align-items: stretch;
      }
      
      .filter-group {
        width: 100%;
      }
      
      .table-container {
        padding: 15px;
      }
      
      table {
        font-size: 12px;
      }
      
      th, td {
        padding: 12px 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <div class="logo-icon">üìä</div>
        <div class="logo-text">
          <h1>Trade Scanner Pro</h1>
          <p data-i18n="subtitle">Real-time cryptocurrency market tracking system</p>
        </div>
      </div>
      <div class="stats">
        <div class="stat-item">
          <span class="stat-value" id="totalPairs">-</span>
          <span class="stat-label" data-i18n="totalPairs">Total Pairs</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="exchanges">-</span>
          <span class="stat-label" data-i18n="exchanges">Exchanges</span>
        </div>
        <button class="lang-toggle" id="langToggle">üåê TR</button>
      </div>
    </div>

    <div class="controls-panel">
      <div class="search-section">
        <div class="search-wrapper">
          <span class="search-icon">üîç</span>
          <input 
            id="searchInput" 
            type="search" 
            class="search-input" 
            data-i18n-placeholder="searchPlaceholder"
            placeholder="Search symbol (e.g., BTCUSDT, ETH-USD)..."
          >
        </div>
      </div>

      <div class="filters">
        <div class="filter-group" id="filterMidline">
          <div class="checkbox" id="checkMidline"></div>
          <span class="filter-label" data-i18n="filterMidline">üéØ Asia 50% Midline Touch</span>
        </div>
        
        <div class="filter-group" id="filterFib">
          <div class="checkbox" id="checkFib"></div>
          <span class="filter-label" data-i18n="filterFib">üìà Fib50 Touch</span>
        </div>
        
        <button class="btn btn-primary" id="refreshBtn">
          <span>üîÑ</span>
          <span data-i18n="refresh">Refresh</span>
        </button>
        
        <button class="export-btn" id="exportBtn">
          <span>üì•</span>
          <span data-i18n="export">Export CSV</span>
        </button>
      </div>
    </div>

    <div class="table-container">
      <div class="table-header">
        <h2 class="table-title" data-i18n="scanResults">Scan Results</h2>
        <span class="result-count" id="resultCount" data-i18n-suffix=" results">0 results</span>
      </div>
      
      <div id="tableContent">
        <div class="loading">
          <div class="spinner"></div>
          <div class="loading-text" data-i18n="loading">Loading data...</div>
        </div>
      </div>
    </div>

    <div class="footer">
      <span data-i18n="updateTime">Update Time</span>: <span id="updateTime">-</span> | 
      <a href="https://github.com/saracevic/Trade" target="_blank" rel="noopener noreferrer">GitHub</a>
    </div>
  </div>

  <script>
    let scanData = null;
    let midlineFilter = false;
    let fibFilter = false;
    let currentLang = 'en';

    // Internationalization
    const translations = {
      en: {
        subtitle: 'Real-time cryptocurrency market tracking system',
        totalPairs: 'Total Pairs',
        exchanges: 'Exchanges',
        searchPlaceholder: 'Search symbol (e.g., BTCUSDT, ETH-USD)...',
        filterMidline: 'üéØ Asia 50% Midline Touch',
        filterFib: 'üìà Fib50 Touch',
        refresh: 'Refresh',
        export: 'Export CSV',
        scanResults: 'Scan Results',
        results: 'results',
        loading: 'Loading data...',
        updateTime: 'Update Time',
        noResults: 'No results found',
        noResultsSubtext: 'Try different filters or search criteria',
        errorLoading: 'Error loading data',
        exchange: 'Exchange',
        symbol: 'Symbol',
        asiaMidline: 'Asia Midline',
        fib50: 'Fib50',
        ath: 'ATH',
        atl: 'ATL'
      },
      tr: {
        subtitle: 'Ger√ßek zamanlƒ± kripto piyasa takip sistemi',
        totalPairs: 'Toplam √áift',
        exchanges: 'Borsa',
        searchPlaceholder: 'Sembol ara (√∂rn. BTCUSDT, ETH-USD)...',
        filterMidline: 'üéØ Asia 50% Midline Temas',
        filterFib: 'üìà Fib50 Temas',
        refresh: 'Yenile',
        export: 'CSV ƒ∞ndir',
        scanResults: 'Tarama Sonu√ßlarƒ±',
        results: 'sonu√ß',
        loading: 'Veriler y√ºkleniyor...',
        updateTime: 'G√ºncelleme Zamanƒ±',
        noResults: 'Sonu√ß bulunamadƒ±',
        noResultsSubtext: 'Farklƒ± filtreler veya arama kriterleri deneyebilirsiniz',
        errorLoading: 'Veri y√ºklenirken hata olu≈ütu',
        exchange: 'Borsa',
        symbol: 'Sembol',
        asiaMidline: 'Asia Midline',
        fib50: 'Fib50',
        ath: 'ATH',
        atl: 'ATL'
      }
    };

    function translate(key) {
      return translations[currentLang][key] || key;
    }

    function updateLanguage() {
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        el.textContent = translate(key);
      });
      
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
        const key = el.getAttribute('data-i18n-placeholder');
        el.placeholder = translate(key);
      });
      
      // Update result count
      renderTable();
    }

    function toggleLanguage() {
      currentLang = currentLang === 'en' ? 'tr' : 'en';
      document.getElementById('langToggle').textContent = currentLang === 'en' ? 'üåê TR' : 'üåê EN';
      updateLanguage();
    }

    function exportToCSV() {
      if (!scanData || !scanData.results) return;
      
      const results = scanData.results || [];
      const searchQuery = document.getElementById('searchInput').value.trim().toUpperCase();
      
      // Filter results
      const filtered = results.filter(r => {
        if (searchQuery && !r.symbol.includes(searchQuery)) return false;
        if (midlineFilter && !r.midline_touch) return false;
        if (fibFilter && (!r.fib_touches || r.fib_touches.length === 0)) return false;
        return true;
      });
      
      // Create CSV content
      let csv = 'Exchange,Symbol,Asia Midline Price,Asia Midline Time,Fib50,ATH,ATL\n';
      
      filtered.forEach(r => {
        const exchange = r.exchange || '';
        const symbol = r.symbol || '';
        const midlinePrice = r.midline_touch ? r.midline_touch.price : '';
        const midlineTime = r.midline_touch ? r.midline_touch.time : '';
        const fib50 = r.fib50 || '';
        const ath = r.ath || '';
        const atl = r.atl || '';
        
        csv += `${exchange},${symbol},${midlinePrice},${midlineTime},${fib50},${ath},${atl}\n`;
      });
      
      // Download CSV
      const blob = new Blob([csv], { type: 'text/csv' });
      const url = window.URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `trade-scanner-${new Date().toISOString().split('T')[0]}.csv`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      setupEventListeners();
      loadData();
    });

    function setupEventListeners() {
      document.getElementById('searchInput').addEventListener('input', renderTable);
      document.getElementById('filterMidline').addEventListener('click', toggleMidlineFilter);
      document.getElementById('filterFib').addEventListener('click', toggleFibFilter);
      document.getElementById('refreshBtn').addEventListener('click', loadData);
      document.getElementById('langToggle').addEventListener('click', toggleLanguage);
      document.getElementById('exportBtn').addEventListener('click', exportToCSV);
    }

    function toggleMidlineFilter() {
      midlineFilter = !midlineFilter;
      document.getElementById('filterMidline').classList.toggle('active');
      document.getElementById('checkMidline').classList.toggle('checked');
      renderTable();
    }

    function toggleFibFilter() {
      fibFilter = !fibFilter;
      document.getElementById('filterFib').classList.toggle('active');
      document.getElementById('checkFib').classList.toggle('checked');
      renderTable();
    }

    async function loadData() {
      try {
        const res = await fetch('./results.json');
        if (res.ok) {
          scanData = await res.json();
        } else {
          const fallbackUrl = `https://raw.githubusercontent.com/saracevic/Trade/main/results.json?t=${Date.now()}`;
          const fallbackRes = await fetch(fallbackUrl);
          if (!fallbackRes.ok) throw new Error('Fallback fetch failed');
          scanData = await fallbackRes.json();
        }
        renderTable();
      } catch (error) {
        console.error('Error loading data:', error);
        document.getElementById('tableContent').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">‚ö†Ô∏è</div>
            <div class="empty-text" data-i18n="errorLoading">${translate('errorLoading')}</div>
            <div class="empty-subtext">${error.message}</div>
          </div>
        `;
      }
    }

    function renderTable() {
      if (!scanData) return;

      const results = scanData.results || [];
      const searchQuery = document.getElementById('searchInput').value.trim().toUpperCase();

      // Filter results
      const filtered = results.filter(r => {
        if (searchQuery && !r.symbol.includes(searchQuery)) return false;
        if (midlineFilter && !r.midline_touch) return false;
        if (fibFilter && (!r.fib_touches || r.fib_touches.length === 0)) return false;
        return true;
      });

      // Update stats
      document.getElementById('totalPairs').textContent = results.length;
      const exchanges = [...new Set(results.map(r => r.exchange).filter(Boolean))];
      document.getElementById('exchanges').textContent = exchanges.length;
      document.getElementById('resultCount').textContent = `${filtered.length} ${translate('results')}`;
      
      const updateTime = scanData.generated_at || new Date().toLocaleString(currentLang === 'tr' ? 'tr-TR' : 'en-US');
      document.getElementById('updateTime').textContent = updateTime;

      // Render table
      if (filtered.length === 0) {
        document.getElementById('tableContent').innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üîç</div>
            <div class="empty-text" data-i18n="noResults">${translate('noResults')}</div>
            <div class="empty-subtext" data-i18n="noResultsSubtext">${translate('noResultsSubtext')}</div>
          </div>
        `;
        return;
      }

      let html = `
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th data-i18n="exchange">${translate('exchange')}</th>
                <th data-i18n="symbol">${translate('symbol')}</th>
                <th data-i18n="asiaMidline">${translate('asiaMidline')}</th>
                <th data-i18n="fib50">${translate('fib50')}</th>
                <th data-i18n="ath">${translate('ath')}</th>
                <th data-i18n="atl">${translate('atl')}</th>
              </tr>
            </thead>
            <tbody>
      `;

      filtered.forEach(r => {
        const exchange = r.exchange ? `<span class="badge badge-exchange">${r.exchange}</span>` : '';
        const midline = r.midline_touch 
          ? `<span class="badge badge-success">${r.midline_touch.price} @ ${r.midline_touch.time}</span>` 
          : '<span class="badge badge-primary">-</span>';
        
        let fib = '';
        if (r.fib_touches && r.fib_touches.length > 0) {
          fib = r.fib_touches.map(ft => 
            `<span class="badge badge-warning">${ft.level} @ ${ft.touch.time}</span>`
          ).join(' ');
        } else if (r.fib50) {
          fib = `<span class="badge badge-primary">${r.fib50}</span>`;
        } else {
          fib = '<span class="badge badge-primary">-</span>';
        }

        html += `
          <tr>
            <td>${exchange}</td>
            <td><span class="symbol">${r.symbol}</span></td>
            <td>${midline}</td>
            <td>${fib}</td>
            <td><span class="price">${r.ath || '-'}</span></td>
            <td><span class="price">${r.atl || '-'}</span></td>
          </tr>
        `;
      });

      html += `
            </tbody>
          </table>
        </div>
      `;

      document.getElementById('tableContent').innerHTML = html;
    }
  </script>
</body>
</html>